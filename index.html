<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>VSCC - Vietnam STEM Career Learning Card</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* --- 1. CSS CHUNG --- */
        :root {
            --primary: #4e54c8; --secondary: #8f94fb;
            --success: #2ed573; --danger: #ff4757;
            --text: #2f3542; --bg: #f8f9fa;
        }
        body { 
            font-family: 'Nunito', sans-serif; margin: 0; padding: 0; 
            background: #e9ecef; color: var(--text); 
            height: 100vh; overflow: hidden;
        }
        .app-container {
            max-width: 480px; height: 100%; margin: 0 auto; background: white; 
            position: relative; box-shadow: 0 0 20px rgba(0,0,0,0.05);
            display: flex; flex-direction: column; 
            overflow-y: auto; overflow-x: hidden;
        }

        /* --- FOOTER (C·∫¨P NH·∫¨T M·ªöI) --- */
        .app-footer {
            background: #f1f2f6; padding: 20px 15px; text-align: center;
            border-top: 1px solid #ddd; margin-top: auto; font-size: 12px;
        }
        .ft-main { font-weight: 800; color: var(--primary); font-size: 14px; margin: 0 0 5px 0; text-transform: uppercase; }
        .ft-sub { font-weight: 600; color: #555; margin: 0 0 10px 0; font-style: italic; }
        .ft-author { color: #333; margin: 2px 0; font-weight: 700; }
        .ft-aff { color: #666; margin: 0; font-size: 11px; }

        /* --- SCREENS --- */
        .screen { display: none; flex-direction: column; flex-grow: 1; padding: 20px; box-sizing: border-box; animation: fadeIn 0.4s ease-out; }
        .screen.active { display: flex; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- UI ELEMENTS --- */
        h1, h2, h3 { text-align: center; margin: 10px 0; color: var(--primary); }
        .logo-area { text-align: center; margin-bottom: 20px; }
        .logo-area img { width: 100px; height: 100px; object-fit: contain; }
        
        /* N√öT VU√îNG TO (TRANG CH·ª¶) */
        .home-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; }
        .btn-square {
            aspect-ratio: 1/1; border: none; border-radius: 20px;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            font-size: 18px; font-weight: 800; cursor: pointer; transition: 0.2s;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05); color: white;
        }
        .btn-square span { font-size: 30px; margin-bottom: 10px; }
        .btn-square:active { transform: scale(0.95); }
        .bg-blue { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .bg-purple { background: linear-gradient(135deg, #89f7fe 0%, #66a6ff 100%); }

        /* INPUTS */
        .btn { width: 100%; padding: 15px; border: none; border-radius: 12px; font-size: 16px; font-weight: 700; cursor: pointer; margin-bottom: 15px; transition: 0.2s; }
        .btn-primary { background: var(--primary); color: white; }
        .btn-outline { background: white; border: 2px solid var(--primary); color: var(--primary); }
        
        input, select { width: 100%; padding: 14px; margin-bottom: 15px; border: 2px solid #eee; border-radius: 10px; font-size: 16px; box-sizing: border-box; outline: none; }
        input:focus { border-color: var(--secondary); }

        /* --- TH∆Ø VI·ªÜN ·∫¢NH 4:3 --- */
        .lib-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; overflow-y: auto; padding-bottom: 20px; }
        .lib-card { background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.05); cursor: pointer; transition: transform 0.2s; }
        .lib-card:active { transform: scale(0.98); }
        .lib-card img { width: 100%; aspect-ratio: 4/3; object-fit: cover; display: block; }
        .lib-info { padding: 10px; text-align: center; }
        .lib-name { font-weight: bold; font-size: 15px; color: #333; margin-bottom: 4px; display: block; }
        .lib-group { font-size: 11px; background: #eee; padding: 2px 8px; border-radius: 10px; color: #666; }
        
        /* HEADER NAV */
        .header-nav { display: flex; align-items: center; margin-bottom: 15px; }
        .back-btn { background: none; border: none; font-size: 24px; cursor: pointer; color: #666; padding-right: 15px;}
        
        /* GENDER & CLASS */
        .form-row { display: flex; gap: 10px; }
        .gender-opt { flex: 1; padding: 12px; text-align: center; border: 1px solid #ddd; border-radius: 8px; cursor: pointer; }
        .gender-opt.selected { background: var(--primary); color: white; border-color: var(--primary); }

        /* SWIPE CARD */
        #card-zone { position: relative; flex-grow: 1; margin: 10px 0; perspective: 1000px; }
        .tinder-card {
            position: absolute; width: 100%; height: 100%; background: white; border-radius: 20px;
            box-shadow: 0 5px 25px rgba(0,0,0,0.1); overflow: hidden; transform-origin: 50% 100%;
        }
        .card-img-area { height: 65%; position: relative; }
        .card-img-area img { width: 100%; height: 100%; object-fit: cover; }
        .card-overlay { position: absolute; bottom: 0; left: 0; width: 100%; background: linear-gradient(to top, rgba(0,0,0,0.8), transparent); color: white; padding: 15px; box-sizing: border-box; }
        .card-info-area { padding: 20px; height: 35%; overflow-y: auto; }
        
        .control-bar { display: flex; justify-content: center; gap: 30px; padding: 10px 0; }
        .action-btn { width: 60px; height: 60px; border-radius: 50%; border: none; font-size: 24px; cursor: pointer; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .btn-dislike { background: white; color: var(--danger); border: 2px solid #eee; }
        .btn-like { background: white; color: var(--success); border: 2px solid #eee; }

        /* REFINE & RESULT */
        .liked-list { flex-grow: 1; overflow-y: auto; margin: 10px 0; }
        .refine-item { display: flex; align-items: center; padding: 12px; background: white; margin-bottom: 8px; border-radius: 8px; border: 2px solid transparent; cursor: pointer; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
        .refine-item.active { border-color: var(--success); background: #f0fff4; }
        .refine-item img { width: 40px; height: 40px; border-radius: 50%; margin-right: 12px; object-fit: cover; }
        .check-icon { margin-left: auto; color: var(--success); opacity: 0; }
        .refine-item.active .check-icon { opacity: 1; }

        .ai-box { background: #eef2f5; padding: 15px; border-radius: 12px; font-size: 14px; line-height: 1.6; margin-bottom: 20px;}
        .loader { border: 3px solid #f3f3f3; border-top: 3px solid var(--primary); border-radius: 50%; width: 20px; height: 20px; animation: spin 1s linear infinite; display: inline-block; margin-right: 10px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* MODAL (ZOOM EFFECT) */
        #modal-info { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 999; display: none; justify-content: center; align-items: center; animation: fadeIn 0.3s; }
        .modal-content { 
            background: white; width: 90%; max-width: 400px; max-height: 85vh; 
            border-radius: 20px; padding: 0; overflow-y: auto; position: relative;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2); transform: scale(0.9); animation: zoomIn 0.3s forwards;
        }
        @keyframes zoomIn { to { transform: scale(1); } }
        
        .modal-brand { text-align: center; padding: 15px; background: #f8f9fa; border-bottom: 1px solid #eee; }
        .modal-brand img { height: 40px; object-fit: contain; }
        .modal-body { padding: 20px; }
        .close-modal { position: absolute; top: 10px; right: 15px; font-size: 28px; cursor: pointer; color: #999; z-index: 10; }
    </style>
</head>
<body>

<div class="app-container">
    
    <div id="screen-home" class="screen active">
        <div class="logo-area" style="margin-top: 40px;">
            <img src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" alt="Logo"> <h2>VSCC APP</h2>
            <p style="color: #777; font-size: 14px;">Vietnam STEM Career Learning Card</p>
        </div>
        
        <div class="home-grid">
            <button class="btn-square bg-blue" onclick="goToScreen('screen-library')">
                <span>üîç</span>
                T√åM HI·ªÇU NGH·ªÄ
            </button>
            <button class="btn-square bg-purple" onclick="goToScreen('screen-input')">
                <span>üîÆ</span>
                D·ª∞ ƒêO√ÅN (AI)
            </button>
        </div>
    </div>

    <div id="screen-library" class="screen">
        <div class="header-nav">
            <button class="back-btn" onclick="goToScreen('screen-home')">‚Üê</button>
            <h3 style="margin:0">Th∆∞ Vi·ªán Ngh·ªÅ</h3>
        </div>
        <input type="text" id="search-lib" placeholder="Nh·∫≠p t√™n ngh·ªÅ..." onkeyup="filterLib()">
        <div id="lib-container" class="lib-grid"></div>
    </div>

    <div id="screen-input" class="screen">
        <div class="header-nav">
            <button class="back-btn" onclick="goToScreen('screen-home')">‚Üê</button>
        </div>
        <div class="logo-area">
             <img src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" style="width:60px; height:60px">
             <h3 style="margin:5px 0">Th√¥ng Tin C√° Nh√¢n</h3>
        </div>

        <label>H·ªç v√† t√™n</label> <input type="text" id="inp-name" placeholder="Nguy·ªÖn VƒÉn A">
        
        <div class="form-row">
            <div style="flex:1">
                <label>NƒÉm sinh</label> <input type="number" id="inp-yob" placeholder="2008">
            </div>
            <div style="flex:1">
                <label>L·ªõp</label> <input type="text" id="inp-class" placeholder="VD: 9A1">
            </div>
        </div>

        <label>Email (Nh·∫≠n k·∫øt qu·∫£)</label> <input type="email" id="inp-email" placeholder="email@example.com">
        
        <label>Gi·ªõi t√≠nh</label>
        <div class="form-row" style="margin-bottom:20px">
            <div class="gender-opt selected" onclick="selectGender('Nam', this)">Nam</div>
            <div class="gender-opt" onclick="selectGender('N·ªØ', this)">N·ªØ</div>
        </div>
        
        <button class="btn btn-primary" style="margin-top:auto" onclick="startQuiz()">B·∫ÆT ƒê·∫¶U ‚ûî</button>
    </div>

    <div id="screen-swipe" class="screen">
        <div style="display:flex; justify-content:space-between; align-items:center">
            <small style="color:#999">Ti·∫øn ƒë·ªô: <span id="progress-count">0/20</span></small>
            <button class="btn-outline" style="width:auto; padding:5px 10px; font-size:12px; border:none" onclick="goToScreen('screen-home')">Tho√°t</button>
        </div>
        <div id="card-zone"></div>
        <div class="control-bar">
            <button class="action-btn btn-dislike" onclick="userSwipe('left')">‚úï</button>
            <button class="action-btn btn-like" onclick="userSwipe('right')">‚ù§</button>
        </div>
    </div>

    <div id="screen-refine" class="screen">
        <h3>Ch·ªçn Top 5 Ngh·ªÅ</h3>
        <p style="font-size:13px; color:#666">B·∫°n ƒë√£ th√≠ch <b id="liked-count">0</b> ngh·ªÅ. H√£y ch·ªçn ra t·ªëi ƒëa 5 ngh·ªÅ b·∫°n ·∫•n t∆∞·ª£ng nh·∫•t.</p>
        <div id="refine-list" class="liked-list"></div>
        <button id="btn-analyze" class="btn btn-primary" disabled onclick="finishAndAnalyze()">PH√ÇN T√çCH K·∫æT QU·∫¢</button>
    </div>

    <div id="screen-result" class="screen">
        <h3>H·ªì S∆° C·ªßa B·∫°n</h3>
        <div class="ai-box" style="background:white; border:1px solid #eee">
            <b>H·ªç t√™n:</b> <span id="res-name"></span><br>
            <b>L·ªõp:</b> <span id="res-class"></span> - <b>NƒÉm sinh:</b> <span id="res-yob"></span><br>
            <b>M√£ Holland:</b> <span id="res-holland" style="color:var(--primary); font-weight:bold"></span>
        </div>
        <h4>ü§ñ AI Ph√¢n T√≠ch</h4>
        <div id="ai-content" class="ai-box">
            <div style="text-align:center; padding:20px"><div class="loader"></div> ƒêang k·∫øt n·ªëi AI...</div>
        </div>
        <button id="btn-send-mail" class="btn btn-primary" onclick="sendEmail()">üìß G·ª¨I V·ªÄ EMAIL</button>
        <button class="btn btn-outline" style="margin-top:10px" onclick="location.reload()">L√†m l·∫°i</button>
    </div>

    <div class="app-footer">
        <h4 class="ft-main">Vietnam STEM Career Learning Card (VSCC)</h4>
        <p class="ft-sub">D·ª± √°n "Th·∫ª h·ªçc t·∫≠p ngh·ªÅ nghi·ªáp STEM"</p>
        <p class="ft-author">BSc. Le Hoang Minh ft. MSc. Duong Thi Yen</p>
        <p class="ft-aff">Faculty of Interdisciplinary Science @VNUHCM - University Of Science</p>
    </div>

</div>

<div id="modal-info">
    <div class="modal-content">
        <span class="close-modal" onclick="closeModal()">√ó</span>
        <div class="modal-brand">
            <img src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" alt="Brand Logo">
            <div style="font-weight:800; color:#4e54c8; font-size:12px; margin-top:5px">VIETNAM STEM CAREER CARD</div>
        </div>
        
        <div class="modal-body">
            <h2 id="m-name-vn" style="margin:0 0 5px 0; text-align:left"></h2>
            <i id="m-name-en" style="color:#666; display:block; margin-bottom:15px"></i>
            <div style="background:#f1f2f6; padding:8px; border-radius:8px; margin-bottom:15px; font-size:13px; font-weight:bold">
                Nh√≥m: <span id="m-group" style="color:var(--primary)"></span>
            </div>
            <p><b>M√¥ t·∫£:</b> <span id="m-desc"></span></p>
            <p><b>M√¥n h·ªçc:</b> <span id="m-subjects"></span></p>
            <p><b>Ph·∫©m ch·∫•t:</b> <span id="m-qualities"></span></p>
            <p><b>Th√∫ v·ªã:</b> <span id="m-fact"></span></p>
        </div>
    </div>
</div>

<script>
    const CONFIG = {
        SHEET_CSV: "https://docs.google.com/spreadsheets/d/e/2PACX-1vTn_AISCPAvNtkZZcjcMn4_80wXuarbci9SyqBqDnnHpB5WM1QShft3xU7HHxgIP_AKz9ffyoEsAd9D/pub?output=csv"
    };

    let rawData = [], user = { name: '', yob: '', class: '', email: '', gender: 'Nam', likedItems: [], finalSelection: [], scores: {} }, quizQueue = [], currentIndex = 0;

    window.onload = async function() {
        try {
            const res = await fetch(CONFIG.SHEET_CSV);
            rawData = parseCSV(await res.text());
            renderLibrary(rawData);
        } catch (e) { alert("L·ªói t·∫£i d·ªØ li·ªáu CSV! H√£y ki·ªÉm tra link trong CONFIG"); }
    };

    function parseCSV(text) {
        const lines = text.trim().split('\n'), result = [];
        for(let i=1; i<lines.length; i++) {
            const row = lines[i].split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
            if(row.length < 2) continue;
            const clean = t => t ? t.replace(/^"|"$/g, '').trim() : "";
            result.push({
                id: clean(row[0]), nameVN: clean(row[1]), nameEN: clean(row[2]),
                group: clean(row[3]), img1: clean(row[4]), img2: clean(row[5]),
                desc: clean(row[6]), subjects: clean(row[7]), qualities: clean(row[8]), fact: clean(row[9])
            });
        }
        return result;
    }

    function goToScreen(id) { document.querySelectorAll('.screen').forEach(s => s.classList.remove('active')); document.getElementById(id).classList.add('active'); }

    /* --- LIBRARY --- */
    function renderLibrary(list) {
        document.getElementById('lib-container').innerHTML = list.map(item => `
            <div class="lib-card" onclick="showModal('${item.id}')">
                <img src="${item.img2 || 'https://via.placeholder.com/400x300'}" loading="lazy">
                <div class="lib-info">
                    <span class="lib-name">${item.nameVN}</span>
                    <span class="lib-group">${item.group}</span>
                </div>
            </div>`).join('');
    }
    function filterLib() {
        const key = document.getElementById('search-lib').value.toLowerCase();
        renderLibrary(rawData.filter(i => i.nameVN.toLowerCase().includes(key)));
    }

    /* --- INPUT & QUIZ --- */
    function selectGender(g, el) { user.gender = g; document.querySelectorAll('.gender-opt').forEach(e => e.classList.remove('selected')); el.classList.add('selected'); }
    
    function startQuiz() {
        user.name = document.getElementById('inp-name').value;
        user.yob = document.getElementById('inp-yob').value;
        user.class = document.getElementById('inp-class').value; // L·∫•y th√¥ng tin l·ªõp
        user.email = document.getElementById('inp-email').value;
        
        if(!user.name || !user.yob || !user.class) { alert("Vui l√≤ng nh·∫≠p ƒë·ªß: T√™n, NƒÉm sinh v√† L·ªõp!"); return; }
        
        const age = new Date().getFullYear() - parseInt(user.yob);
        const useImg1 = (age >= 10 && age <= 15);
        
        quizQueue = rawData.sort(() => 0.5 - Math.random()).slice(0, 20).map(item => ({ ...item, displayImg: useImg1 ? item.img1 : item.img2 }));
        currentIndex = 0; user.likedItems = []; user.scores = {};
        renderCard(); goToScreen('screen-swipe');
    }

    /* --- SWIPE LOGIC --- */
    function renderCard() {
        if(currentIndex >= quizQueue.length) { goToRefineScreen(); return; }
        const item = quizQueue[currentIndex];
        document.getElementById('progress-count').innerText = `${currentIndex + 1}/${quizQueue.length}`;
        
        document.getElementById('card-zone').innerHTML = `
            <div class="tinder-card" id="active-card">
                <div class="card-img-area" onclick="showModal('${item.id}')">
                    <img src="${item.displayImg}" draggable="false">
                    <div class="card-overlay"><h2 style="margin:0; color:white">${item.nameVN}</h2><i style="opacity:0.8">${item.nameEN}</i></div>
                </div>
                <div class="card-info-area"><p style="margin-top:0"><b>M√¥ t·∫£:</b> ${item.desc.substring(0, 100)}...</p><small>(Ch·∫°m ·∫£nh ƒë·ªÉ xem chi ti·∫øt)</small></div>
            </div>`;
        initSwipeEvent();
    }
    
    function userSwipe(dir) {
        const card = document.getElementById('active-card');
        if(!card) return;
        card.style.transition = 'transform 0.4s ease-out, opacity 0.4s';
        card.style.transform = dir === 'left' ? 'translateX(-120%) rotate(-20deg)' : 'translateX(120%) rotate(20deg)';
        card.style.opacity = '0';
        
        const item = quizQueue[currentIndex];
        if(dir === 'right') {
            user.likedItems.push(item);
            const g = item.group.charAt(0);
            user.scores[g] = (user.scores[g] || 0) + 1;
        }
        setTimeout(() => { currentIndex++; renderCard(); }, 300);
    }
    
    function initSwipeEvent() {
        const card = document.getElementById('active-card');
        let startX = 0;
        card.addEventListener('touchstart', e => startX = e.touches[0].clientX);
        card.addEventListener('touchend', e => {
            const delta = e.changedTouches[0].clientX - startX;
            if(delta > 50) userSwipe('right'); else if(delta < -50) userSwipe('left');
        });
    }

    /* --- REFINE --- */
    function goToRefineScreen() {
        if(user.likedItems.length === 0) { user.finalSelection = quizQueue.slice(0,3); finishAndAnalyze(); return; }
        goToScreen('screen-refine');
        document.getElementById('liked-count').innerText = user.likedItems.length;
        document.getElementById('refine-list').innerHTML = user.likedItems.map(item => `
            <div class="refine-item" onclick="toggleSelection('${item.id}', this)">
                <img src="${item.displayImg}"><div><b>${item.nameVN}</b><br><small>${item.group}</small></div>
                <div class="check-icon">‚úî</div>
            </div>`).join('');
        user.finalSelection = []; checkRefineBtn();
    }
    function toggleSelection(id, el) {
        if(el.classList.contains('active')) {
            el.classList.remove('active'); user.finalSelection = user.finalSelection.filter(i => i.id !== id);
        } else {
            if(user.finalSelection.length >= 5) { alert("Ch·ªâ ch·ªçn t·ªëi ƒëa 5 ngh·ªÅ!"); return; }
            el.classList.add('active'); user.finalSelection.push(user.likedItems.find(i => i.id === id));
        }
        checkRefineBtn();
    }
    function checkRefineBtn() {
        const btn = document.getElementById('btn-analyze');
        btn.disabled = user.finalSelection.length === 0;
        btn.innerText = `PH√ÇN T√çCH (${user.finalSelection.length}/5)`;
    }

    /* --- RESULT & AI --- */
    function finishAndAnalyze() {
        goToScreen('screen-result');
        document.getElementById('res-name').innerText = user.name;
        document.getElementById('res-yob').innerText = user.yob;
        document.getElementById('res-class').innerText = user.class; // Hi·ªán l·ªõp ·ªü k·∫øt qu·∫£
        
        const sorted = Object.entries(user.scores).sort((a,b) => b[1] - a[1]);
        const topHolland = sorted.slice(0,2).map(i => i[0]).join("");
        document.getElementById('res-holland').innerText = topHolland || "Ch∆∞a x√°c ƒë·ªãnh";

        const prompt = `
            H·ªçc sinh: ${user.name}, L·ªõp: ${user.class}, Tu·ªïi: ${new Date().getFullYear() - user.yob}.
            M√£ Holland: ${topHolland}.
            Top ngh·ªÅ ƒë√£ ch·ªçn: ${user.finalSelection.map(i => i.nameVN).join(', ')}.
            Vi·∫øt b√°o c√°o h∆∞·ªõng nghi·ªáp (HTML, kh√¥ng markdown):
            1. <b>ƒêi·ªÉm m·∫°nh:</b> D·ª±a tr√™n m√£ ${topHolland}.
            2. <b>Ph√¢n t√≠ch:</b> T·∫°i sao h·ª£p v·ªõi c√°c ngh·ªÅ ƒë√£ ch·ªçn?
            3. <b>L·ªùi khuy√™n:</b> C·ª• th·ªÉ cho h·ªçc sinh l·ªõp ${user.class}.
        `;

        google.script.run
            .withSuccessHandler(function(response) {
                if(response.status === 'success') {
                    document.getElementById('ai-content').innerHTML = response.text;
                    user.aiResult = response.text; 
                } else {
                    document.getElementById('ai-content').innerHTML = "L·ªói: " + response.message;
                }
            })
            .withFailureHandler(function(err) {
                document.getElementById('ai-content').innerHTML = "L·ªói k·∫øt n·ªëi Server: " + err;
            })
            .callGeminiAI(prompt);
    }

    function sendEmail() {
        const btn = document.getElementById('btn-send-mail');
        btn.innerText = "ƒêang g·ª≠i...";
        
        google.script.run
            .withSuccessHandler(function(res) {
                if(res.status === 'success') { alert("ƒê√£ g·ª≠i email!"); btn.innerText = "ƒê√£ g·ª≠i xong"; }
                else { alert("L·ªói g·ª≠i mail: " + res.message); btn.innerText = "Th·ª≠ l·∫°i"; }
            })
            .sendEmailReport({
                name: user.name,
                email: user.email,
                result: user.aiResult
            });
    }

    /* --- MODAL --- */
    function showModal(id) {
        const item = rawData.find(i => i.id === id); if(!item) return;
        document.getElementById('m-name-vn').innerText = item.nameVN;
        document.getElementById('m-name-en').innerText = item.nameEN;
        document.getElementById('m-group').innerText = item.group;
        document.getElementById('m-desc').innerText = item.desc;
        document.getElementById('m-subjects').innerText = item.subjects;
        document.getElementById('m-qualities').innerText = item.qualities;
        document.getElementById('m-fact').innerText = item.fact;
        document.getElementById('modal-info').style.display = 'flex';
    }
    function closeModal() { document.getElementById('modal-info').style.display = 'none'; }
</script>

</body>
</html>
